<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>íŒ€ ê´€ë¦¬</title>
  <link rel="stylesheet" href="/static/css/reset.css" />
  <link rel="stylesheet" href="/static/css/teamSetting.css" />
  <link rel="stylesheet" href="/static/css/m-teamSetting.css" />
  <script
          src="https://code.jquery.com/jquery-3.6.1.min.js"
          integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
          crossorigin="anonymous"
  ></script>
  <script src="/static/js/jQueryCheck.js"></script>
</head>
<body>
<div class="wrap">
  <h1 class="title">íŒ€ ê´€ë¦¬</h1>
  <div class="contentWrap">
    <div class="teamProfile">
      <p class="subTitle">íŒ€ í”„ë¡œí•„</p>
        <div class="article">
          <input
                  type="text"
                  name="teamName"
                  id="teamName"
                  class="input_text"
                  th:value="${teamDto.getTeamName()}"
                  disabled
          />
          <input type="hidden" id="teamSeqHidden" th:value="${teamDto.getTeamSeq()}">
          <div id="updateDiv">
          <button type="button" id="changeTeam" class="editBtn">
            ë³€ê²½
          </button>
          </div>
        </div>
    </div>

    <div class="memberProfile">
      <p class="subTitle">ë©¤ë²„ ê´€ë¦¬</p>
      <div th:if="${teamMemberDtoList!=null}">
        <th:block th:each="teamMemberDtoList : ${teamMemberDtoList}">
        <div class="article">
          <div class="metaData">
            <img src="" alt="" class="profileImg" />
            <div class="texts">
              <input
                      type="text"
                      name="memberName"
                      id="memberName"
                      class="inputText"
                      th:value="${teamMemberDtoList.teamMemberNickname}"
                      readonly
              />
              <input
                      type="text"
                      name="memberEmail"
                      id="memberEmail"
                      class="inputEmail"
                      th:value="${teamMemberDtoList.memberId}"
                      readonly
              />
            </div>
          </div>
          <div class="btns">
            <button
                    type="button"
                    name="grade"
                    id="grade"
                    class="gradeBtn"
                    onclick="opener(this)"
                    th:seq="${teamMemberDtoList.memberSeq}"
            >
              ë“±ê¸‰
            </button>
            <button type="submit" class="editBtn" id="eidtMember">
              ë³€ê²½
            </button>
            <button type="submit" class="delBtn" id="delMember">
              ê°•í‡´
            </button>
          </div>
        </div>
        </th:block>
      </div>
    </div>
  </div>
    <div class="modal">
      <div class="modalWrap">
        <h1>ğŸ¤”</h1>
        <h3>
          member ë‹˜ì˜ ë“±ê¸‰ì„ <br />
          ì–´ë–»ê²Œ ë³€ê²½í• ê¹Œìš”?
        </h3>
        <button id="master" class="modalBtn" onclick="changer(this)">
          ë§ˆìŠ¤í„°
        </button>
        <button id="manager" class="modalBtn" onclick="changer(this)">
          ë§¤ë‹ˆì €
        </button>
        <button
                id="staff"
                type="button"
                class="modalBtn"
                onclick="changer(this)"
        >
          íŒ€ì›
        </button>
        <button id="goBack" type="button" onclick="closer()">ë‚˜ê°€ê¸°</button>
      </div>
    </div>

  <form action="/team/deleteTeam" id="deleteTeam" method="post">
    <input type="hidden" name="teamSeq" id="teamSeq" th:value="${teamDto.getTeamSeq()}">
  <p style="text-align: center; margin-top: 20px;">íŒ€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? <a href="#" onclick="delClick()"><strong>ì‚­ì œ</strong></a></p>
  </form>
</div>
<script>
  var modal = document.querySelector(".modal");
  var grade = document.querySelector("#grade");
  var gradeBtn = document.querySelector(".gradeBtn");
  var modalBtn = document.querySelectorAll(".modalBtn");
  var master = document.querySelector("#master");
  var manager = document.querySelector("#manager");
  var staff = document.querySelector("#staff");
  var choice = $(".staff").html();
  // modal ì—´ë¦¼ í•¨ìˆ˜
  function closer() {
    modal.style.display = "none";
  }
  // modal ë‹«í˜ í•¨ìˆ˜
  function opener() {
    modal.style.display = "block";
  }
  // ë“±ê¸‰ ì„ íƒì‹œ ì´ë²¤íŠ¸ í–‰ë™
  function changer(e) {
    grade.innerText = e.innerText;
    modal.style.display = "none";
  }

 // íŒ€ ì‚­ì œ ì‹œ ê²½ê³ ë©”ì„¸ì§€
function delClick() {
  if (confirm("íŒ€ì„ ì •ë§ ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    $("#deleteTeam").submit();
    alert("íŒ€ì´ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤");
    return true;
  } else {
    alert("ì˜ ìƒê°í•˜ì…¨ì–´ìš”!");
    return false;
  }
}

</script>

<script>
  //íŒ€ ì´ë¦„ ë³€ê²½
  let updateTeamNameBtn = $("<button>");
  updateTeamNameBtn.text("ì™„ë£Œ");
  updateTeamNameBtn.attr("type", "button");
  updateTeamNameBtn.attr("id", "updateTeamNameBtn");
  updateTeamNameBtn.attr("class","editBtn");

  $("#changeTeam").on("click",function (){
    $("#teamName").attr("disabled", false);
    $("#changeTeam").css("display","none");
    $("#teamName").css("border","2px dashed magenta");
    $('#updateDiv').append(updateTeamNameBtn);
  })

  updateTeamNameBtn.on("click",function () {
    let teamName = $("#teamName").val();
    let teamSeq = $("#teamSeqHidden").val();
    $.ajax({
      url: "/team/updateTeamName",
      data: {
        "teamName": teamName,
        "teamSeq": teamSeq
      },
      success: function () {
      }, error: function () {
      }
    }).done(function () {
      alert("íŒ€ ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
      $("#teamName").val(teamName);
      $("#teamName").attr("disabled", true);
      $("#changeTeam").css("display","block");
      updateTeamNameBtn.css("display","none");
      $("#teamName").css("border", "none");
    })
  })
</script>

</body>
</html>
